#!/bin/bash

echo "=========================================================="
echo "====================== bandit scan ======================="
echo "=========================================================="
bandit -r -c 'bandit.config' .
echo "=========================================================="


echo "=========================================================="
echo "====================== PEP 8 ERRORS ======================"
echo "=========================================================="
flake8
echo "=========================================================="

echo "=========================================================="
echo "======================== Testing ========================="
echo "=========================================================="
coverage run --source=. --omit=manage.py,tests/* -m pytest tests
coverage report --omit=manage.py,tests/* -m
echo "=========================================================="

#echo "=========================================================="
#echo "===================== Running seeds.. ===================="
#echo "=========================================================="
#python manage.py seed


# start app
gunicorn --bind 0.0.0.0:5002 --reload --worker-class=gevent --worker-connections=1000 --workers=3 manage:app
exec "$@"
